var app={init:function(){this.pageConfig(),this.initFeedbacksSlider(),this.togglePopUpWin(),this.showScrollButton(),this.scrollTop(),this.timerCountdown(),this.checkCopyDate(),this.checkVisibility(),this.checkJS()},pageConfig:function(){$.getJSON("/pageConfig.json",function(e){var t=e.price.currency,i=e.price.price+t,a=e.price.specialPrice+t,n=e.brand.name,o=e.brand.slogan;$(".price").each(function(){$(this).find("s").html(i),$(this).find("b").html(a)}),$(".slogan").html(o),$(".brandName").html(n)})},initFeedbacksSlider:function(){feedbacksSlider=jQuery(".feedbacksSlider"),feedbacksSlider.length&&feedbacksSlider.owlCarousel({singleItem:!0,itemsCustom:!1,slideSpeed:500,transitionStyle:"backSlide",mouseDrag:!1,autoHeight:!0,lazyLoad:!0})},togglePopUpWin:function(){var e=$(".popUpWin"),t=$(".winTrigger");t.click(function(){e.toggleClass("active")}),$(document).keydown(function(t){27==t.keyCode&&e.removeClass("active")})},validateForm:function(e){var t=e.find($('input[name="name"]')),i=e.find($('input[name="phone"]')),a=t.val().match(/[А-я]{2,32}/),n=i.val().match(/^80\d{9}$/),o=t.next("label").hasClass("active"),s=i.next("label").hasClass("active");if(a)if(n)a&&n&&(app.formRequest(e),t.val(""),i.val(""));else{if(s)return!1;app.showMessageBlock(i,"#phoneValidationFailed")}else{if(o)return!1;app.showMessageBlock(t,"#nameValidationFailed")}},formRequest:function(e){var t="/forms.php";e.addClass("loading"),$.ajax({type:"POST",url:t,data:e.serialize(),success:function(){e.removeClass("loading"),app.showMessageBlock(e,"#successMessage")},error:function(){e.removeClass("loading"),app.showMessageBlock(e,"#errorMessage")}})},showMessageBlock:function(e,t){e.after($(t)),$(t).addClass("active")},hideMessageBlock:function(e){$(e).removeClass("active")},scrollTop:function(){$(".scrollTop").click(function(){$("html, body").animate({scrollTop:0},600)})},showScrollButton:function(){var e=window.innerHeight,t=window.pageYOffset,i=$(".scrollTop");t>e?i.addClass("active"):i.removeClass("active")},timerCountdown:function(){var e=2,t=$(".qty"),i=t.find(".blue"),a=t.find(".black"),n=t.find(".white"),o=t.find(".cyan");$.getJSON("/pageConfig.json",function(t){for(var s=t.schedule,l=0;l<s.length;l++){var c=new Date(s[l].promoStart),r=new Date(s[l].promoEnd),p=new Date;r>=p&&p>=c&&($("#timer").countdown({timestamp:r}),i.html(Math.ceil(1.3*e*(r.getDate()+1-p.getDate()))),a.html(Math.ceil(e*(r.getDate()+1-p.getDate()))),n.html(Math.floor(1.3*e*(r.getDate()+1-p.getDate()))),o.html(Math.floor(.8*e*(r.getDate()+1-p.getDate()))))}})},checkJS:function(){$(".page").removeClass("noJS")},checkCopyDate:function(){var e=2015,t=document.title,i=(new Date).getFullYear();$(".copy").find("h6").html(i>e?"&copy;&nbsp;"+e+" - "+i+"&nbsp;"+t:"&copy;&nbsp;"+e+"&nbsp;"+t)},checkVisibility:function(){$(".scroll-visible:in-viewport").addClass("active")}};jQuery(function(e){app.init(),e('input[type="submit"]').click(function(t){var i=e(this).closest("form");app.validateForm(i),t.preventDefault()}),e(window).scroll(function(){app.showScrollButton(),app.checkVisibility()})});